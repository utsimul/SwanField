# MAARS

## Multi Agent Atmospheric Reinforcement Swans


![alt text](MAARS.png)

I aim to use Multi Agent Deep Reinforcment Learning and concepts of atmospheric modelling in order to implement portfolio optimization while detecting Black Swan events. 

Will be updating my progress here for sanity.

### Step 1: Fetching and Pre processing:
Obtained data from yahoo finance API.
Arranging them in a format.
Normalization (Min Max scaling), 
Computed features ('SMA_20', 'EMA_20', 'RSI_14', 'BB_High', 'BB_Low', 'Volatility_20', 'Hurst')
Fit GARCH model for volatility forecasting.

After pre processing, the data looks like:

##### AAPL
{'AAPL':                  close        high         low        open     volume  \
 Date                                                                    
 2020-01-02   72.620834   72.681281   71.373211   71.627084  135480400   
 2020-01-03   71.914833   72.676462   71.689973   71.847133  146322800   
 2020-01-06   72.487862   72.526549   70.783263   71.034724  118387200   
 2020-01-07   72.146927   72.753808   71.926900   72.497514  108872000   
 2020-01-08   73.307518   73.609752   71.849540   71.849540  132079200   
 ...                ...         ...         ...         ...        ...   
 2024-12-23  254.655716  255.034791  252.840088  254.156919   40858800   
 2024-12-24  257.578674  257.588630  254.675658  254.875189   23234700   
 2024-12-26  258.396667  259.474086  257.010028  257.568678   27237100   
 2024-12-27  254.974930  258.077462  252.451019  257.209530   42355300   
 2024-12-30  251.593094  252.889969  250.146586  251.623020   35557500   
 
               return  volatility  momentum  sharpe_ratio  regime_state  
 Date                                                                    
 2020-01-02       NaN         NaN       NaN           NaN           NaN  
 2020-01-03 -0.009769         NaN       NaN           NaN           NaN  
 2020-01-06  0.007937         NaN       NaN           NaN           NaN  
 2020-01-07 -0.004714         NaN       NaN           NaN           NaN  
 2020-01-08  0.015958         NaN       NaN           NaN           NaN  
 ...              ...         ...       ...           ...           ...  
 2024-12-23  0.003060    0.008670  0.005271      9.652099           1.0  
 2024-12-24  0.011413    0.008772  0.005534     10.014809           0.0  
 2024-12-26  0.003171    0.008617  0.005068      9.336628           1.0  
 2024-12-27 -0.013331    0.009435  0.003987      6.708576           0.0  
 2024-12-30 -0.013352    0.010131  0.003378      5.292881           1.0  

1257 rows x 10 columns

##### MSFT:
'MSFT':                  close        high         low        open    volume  \
 Date                                                                   
 2020-01-02  153.042282  153.147093  150.860326  151.289093  22622100   
 2020-01-03  151.136658  152.403913  150.603080  150.850823  21116200   
 2020-01-06  151.527298  151.594002  149.126182  149.669298  20813700   
 2020-01-07  150.145721  152.137116  149.897993  151.803637  21634100   
 2020-01-08  152.537323  153.213833  150.498284  151.432046  27746500   
 ...                ...         ...         ...         ...       ...   
 2024-12-23  433.583038  435.973841  431.172293  435.067322  19152500   
 2024-12-24  437.647400  437.916385  432.527101  432.985331   7164500   
 2024-12-26  436.432068  439.251246  434.957756  437.398354   8194200   
 2024-12-27  428.881104  433.553144  424.717120  432.935523  18117700   
 2024-12-30  423.202911  425.912495  420.284140  424.428211  13158700   
 
               return  volatility  momentum  sharpe_ratio  regime_state  
 Date                                                                    
 2020-01-02       NaN         NaN       NaN           NaN           NaN  
 2020-01-03 -0.012530         NaN       NaN           NaN           NaN  
 2020-01-06  0.002581         NaN       NaN           NaN           NaN  
 2020-01-07 -0.009159         NaN       NaN           NaN           NaN  
 2020-01-08  0.015803         NaN       NaN           NaN           NaN  
 ...              ...         ...       ...           ...           ...  
 2024-12-23 -0.003097    0.012492  0.002514      3.194466           1.0  
 2024-12-24  0.009330    0.012474  0.002484      3.161266           1.0  
 2024-12-26 -0.002781    0.012518  0.002148      2.723504           1.0  
 2024-12-27 -0.017453    0.012373  0.000282      0.361525           1.0  
 2024-12-30 -0.013328    0.012454  0.000207      0.263467           1.0  
 
 1257 rows x 10 columns,

 ##### GOOGL:

 'GOOGL':                  close        high         low        open    volume  \
 Date                                                                   
 2020-01-02   68.026016   68.026016   66.923134   67.018562  27278000   
 2020-01-03   67.670151   68.278009   66.964384   66.998186  23408000   
 2020-01-06   69.473846   69.499192   67.147300   67.178606  46768000   
 2020-01-07   69.339645   69.756647   69.163206   69.605552  34330000   
 2020-01-08   69.833183   70.171653   69.216384   69.325228  35314000   
 ...                ...         ...         ...         ...       ...   
 2024-12-23  194.171036  194.639929  189.701589  192.165766  25675000   
 2024-12-24  195.647552  195.647552  193.323045  194.380543  10403300   
 2024-12-26  195.138748  196.286030  193.921624  194.689797  12046600   
 2024-12-27  192.305435  194.859411  190.200410  194.490273  18891400   
 2024-12-30  190.789047  192.095956  188.674036  189.352440  14264700   
 
               return  volatility  momentum  sharpe_ratio  regime_state  
 Date                                                                    
 2020-01-02       NaN         NaN       NaN           NaN           NaN  
 2020-01-03 -0.005245         NaN       NaN           NaN           NaN  
 2020-01-06  0.026305         NaN       NaN           NaN           NaN  
 2020-01-07 -0.001934         NaN       NaN           NaN           NaN  
 2020-01-08  0.007092         NaN       NaN           NaN           NaN  
 ...              ...         ...       ...           ...           ...  
 2024-12-23  0.016683    0.022171  0.007166      5.130955           NaN  
 2024-12-24  0.007575    0.021453  0.008349      6.178099           NaN  
 2024-12-26 -0.002604    0.021475  0.007397      5.467918           NaN  
 2024-12-27 -0.014626    0.022001  0.006285      4.534744           NaN  
 2024-12-30 -0.007917    0.022189  0.005877      4.204413           NaN  
 
 1257 rows x 10 columns
 
